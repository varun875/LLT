<wpfui:UiPage
    x:Class="LenovoLegionToolkit.WPF.Pages.BatteryPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:controls="clr-namespace:LenovoLegionToolkit.WPF.Controls"
    xmlns:custom="clr-namespace:LenovoLegionToolkit.WPF.Controls.Custom"
    xmlns:resources="clr-namespace:LenovoLegionToolkit.WPF.Resources"
    xmlns:dashboard="clr-namespace:LenovoLegionToolkit.WPF.Controls.Dashboard"
    xmlns:libres="clr-namespace:LenovoLegionToolkit.Lib.Resources;assembly=LenovoLegionToolkit.Lib"
    xmlns:utils="clr-namespace:LenovoLegionToolkit.WPF.Utils"
    xmlns:wpfui="http://schemas.lepo.co/wpfui/2022/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    Title="{x:Static resources:Resource.BatteryPage_Title}"
    FlowDirection="{x:Static utils:LocalizationHelper.Direction}"
    Scrollable="True"
    mc:Ignorable="d">

    <Grid Margin="0,0,16,12">
        <!-- Background Gradient -->
        <Grid.Background>
            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                <GradientStop Color="#00FFFFFF" Offset="0"/>
                <GradientStop Color="#05FFFFFF" Offset="1"/>
            </LinearGradientBrush>
        </Grid.Background>

        <StackPanel>
            <!-- Header Section -->
            <Grid Margin="0,16,0,32">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

<<<<<<< Updated upstream
                <TextBlock
                    Grid.Column="0"
                    VerticalAlignment="Center"
                    FontSize="28"
                    FontWeight="SemiBold"
                    Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                    Text="{x:Static resources:Resource.BatteryPage_Title}" />

                <!-- Status Indicator -->
                <Border
                    Grid.Column="2"
                    CornerRadius="20"
                    Background="{DynamicResource ControlFillColorDefaultBrush}"
                    BorderBrush="{DynamicResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    Padding="12,6">
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                        <wpfui:SymbolIcon
                            x:Name="_statusIcon"
                            FontSize="16"
                            Symbol="BatteryCharge24"
                            Foreground="{DynamicResource SystemFillColorSuccessBrush}" />
                        <TextBlock
                            x:Name="_quickStatus"
                            Margin="8,0,0,0"
                            VerticalAlignment="Center"
                            FontSize="14"
                            FontWeight="Medium"
                            Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                            Text="Healthy" />
                    </StackPanel>
                </Border>
            </Grid>

            <!-- Main Battery Display -->
            <Grid Margin="0,0,0,32">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="32"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Battery Visualization Card -->
                <custom:CardControl
                    Grid.Column="0"
                    Background="{DynamicResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{DynamicResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    Effect="{DynamicResource CardShadow}">
                    <custom:CardControl.Header>
                        <controls:CardHeaderControl
                            Title="Battery Status"
                            Subtitle="Real-time battery information" />
                    </custom:CardControl.Header>

                    <Grid Margin="0,16,0,16">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Battery Icon and Percentage -->
                        <Grid Grid.Row="0" HorizontalAlignment="Center" VerticalAlignment="Center" MinHeight="200">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <!-- Animated Battery Icon -->
                            <Viewbox Grid.Row="0" Width="120" Height="120">
                                <Canvas Width="24" Height="24">
                                    <Border
                                        x:Name="_batteryBorder"
                                        Width="20"
                                        Height="12"
                                        Background="Transparent"
                                        BorderBrush="{DynamicResource TextFillColorSecondaryBrush}"
                                        BorderThickness="2"
                                        CornerRadius="2"
                                        Canvas.Left="2"
                                        Canvas.Top="6">
                                        <Border
                                            x:Name="_batteryFill"
                                            Background="{DynamicResource SystemFillColorSuccessBrush}"
                                            CornerRadius="1"
                                            Margin="1"
                                            Width="14" />
                                    </Border>

                                    <!-- Battery Terminal -->
                                    <Rectangle
                                        Width="3"
                                        Height="4"
                                        Fill="{DynamicResource TextFillColorSecondaryBrush}"
                                        Canvas.Left="21"
                                        Canvas.Top="8" />

                                    <!-- Charging Animation Overlay -->
                                    <Border
                                        x:Name="_chargingOverlay"
                                        Width="20"
                                        Height="12"
                                        Background="{DynamicResource SystemFillColorSuccessBrush}"
                                        CornerRadius="2"
                                        Canvas.Left="2"
                                        Canvas.Top="6"
                                        Opacity="0">
                                        <wpfui:SymbolIcon
                                            Symbol="Flash24"
                                            Foreground="White"
                                            FontSize="8"
                                            HorizontalAlignment="Center"
                                            VerticalAlignment="Center" />
                                    </Border>
                                </Canvas>
                            </Viewbox>

                            <!-- Percentage Text -->
                            <TextBlock
                                x:Name="_percentRemaining"
                                Grid.Row="1"
                                Margin="0,16,0,8"
                                HorizontalAlignment="Center"
                                FontSize="48"
                                FontWeight="Bold"
                                Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                Text="85%" />

                            <!-- Status Text -->
                            <TextBlock
                                x:Name="_status"
                                Grid.Row="2"
                                HorizontalAlignment="Center"
                                FontSize="16"
                                FontWeight="Medium"
                                Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                                Text="3h 42m remaining" />
                        </Grid>

                        <!-- Battery Level Bar -->
                        <ProgressBar Grid.Row="1"
                            x:Name="_batteryProgressBar"
                            Height="8"
                            Margin="0,16,0,0"
                            Background="{DynamicResource ControlFillColorDefaultBrush}"
                            BorderThickness="0"
                            Foreground="{DynamicResource SystemFillColorSuccessBrush}"
                            Maximum="100"
                            Minimum="0"
                            Value="85" />
                    </Grid>
                </custom:CardControl>

                <!-- Spacer -->
                <Grid Grid.Column="1"/>

                <!-- Battery Health Card -->
                <custom:CardControl
                    Grid.Column="2"
                    Background="{DynamicResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{DynamicResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    Effect="{DynamicResource CardShadow}">
                    <custom:CardControl.Header>
                        <controls:CardHeaderControl
                            Title="Battery Health"
                            Subtitle="Capacity and condition" />
                    </custom:CardControl.Header>

                    <Grid Margin="0,16,0,16">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Health Gauge -->
                        <Grid Grid.Row="0" HorizontalAlignment="Center" VerticalAlignment="Center" MinHeight="200">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <!-- Circular Health Indicator -->
                            <Viewbox Grid.Row="0" Width="100" Height="100">
                                <Canvas Width="24" Height="24">
                                    <!-- Background Circle -->
                                    <Ellipse
                                        Width="20"
                                        Height="20"
                                        Stroke="{DynamicResource ControlFillColorDefaultBrush}"
                                        StrokeThickness="3"
                                        Canvas.Left="2"
                                        Canvas.Top="2" />

                                    <!-- Health Arc -->
                                    <Path
                                        x:Name="_healthArc"
                                        Stroke="{DynamicResource SystemFillColorSuccessBrush}"
                                        StrokeThickness="3"
                                        StrokeStartLineCap="Round"
                                        StrokeEndLineCap="Round">
                                        <Path.Data>
                                            <PathGeometry>
                                                <PathFigure StartPoint="12,2">
                                                    <ArcSegment
                                                        x:Name="_healthArcSegment"
                                                        Size="10,10"
                                                        SweepDirection="Clockwise"
                                                        IsLargeArc="False" />
                                                </PathFigure>
                                            </PathGeometry>
                                        </Path.Data>
                                    </Path>

                                    <!-- Center Icon -->
                                    <wpfui:SymbolIcon
                                        Symbol="Heart24"
                                        Foreground="{DynamicResource SystemFillColorSuccessBrush}"
                                        FontSize="8"
                                        Canvas.Left="8"
                                        Canvas.Top="8" />
                                </Canvas>
                            </Viewbox>

                            <!-- Health Percentage -->
                            <TextBlock
                                x:Name="_batteryHealthText"
                                Grid.Row="1"
                                Margin="0,16,0,8"
                                HorizontalAlignment="Center"
                                FontSize="32"
                                FontWeight="Bold"
                                Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                Text="92%" />

                            <!-- Health Status -->
                            <TextBlock
                                Grid.Row="2"
                                HorizontalAlignment="Center"
                                FontSize="14"
                                FontWeight="Medium"
                                Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                                Text="Excellent" />
                        </Grid>

                            <!-- Health Bar -->
                        <ProgressBar Grid.Row="1"
                            x:Name="_healthProgressBar"
                            Height="8"
                            Margin="0,16,0,0"
                            Background="{DynamicResource ControlFillColorDefaultBrush}"
                            BorderThickness="0"
                            Foreground="{DynamicResource SystemFillColorSuccessBrush}"
                            Maximum="100"
                            Minimum="0"
                            Value="92" />
                    </Grid>
                </custom:CardControl>
            </Grid>

            <!-- Battery Controls: Mode + Overnight Charging (responsive/compact) -->
            <StackPanel Margin="0,0,0,32">
                <!-- Enhanced Battery Mode Card -->
                <custom:CardControl
                    x:Name="_batteryModeCard"
                    Background="{DynamicResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{DynamicResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    Effect="{DynamicResource CardShadow}">
                    <custom:CardControl.Header>
                        <controls:CardHeaderControl
                            Title="{x:Static resources:Resource.BatteryModeControl_Title}"
                            Subtitle="{x:Static resources:Resource.BatteryModeControl_Message}" />
                    </custom:CardControl.Header>

                    <!-- Wrap buttons so they fit smaller widths without needing full screen -->
                    <WrapPanel Margin="12,8,12,16" ItemHeight="Auto" Orientation="Horizontal">
                        <!-- Conservation Mode -->
                        <Button x:Name="_modeConservationButton"
                                Padding="12"
                                MinWidth="150"
                                Margin="0,0,12,12"
                                Background="{DynamicResource SubtleFillColorTransparentBrush}"
                                BorderBrush="{DynamicResource CardStrokeColorDefaultBrush}"
                                BorderThickness="1"
                                HorizontalContentAlignment="Stretch"
                                VerticalContentAlignment="Stretch"
                                Tag="Conservation"
                                Click="ModeButton_Click">
                            <StackPanel>
                                <wpfui:SymbolIcon Symbol="BatterySaver24"
                                                  Foreground="{DynamicResource SystemFillColorSuccessBrush}"
                                                  FontSize="20"/>
                                <TextBlock Margin="0,8,0,2" Text="{x:Static libres:Resource.BatteryState_Conservation}"
                                           FontWeight="SemiBold"
                                           Foreground="{DynamicResource TextFillColorPrimaryBrush}"/>
                                <TextBlock Text="Extend longevity by limiting max charge"
                                           FontSize="12"
                                           Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
                            </StackPanel>
                        </Button>

                        <!-- Normal Mode -->
                        <Button x:Name="_modeNormalButton"
                                Padding="12"
                                MinWidth="150"
                                Margin="0,0,12,12"
                                Background="{DynamicResource SubtleFillColorTransparentBrush}"
                                BorderBrush="{DynamicResource CardStrokeColorDefaultBrush}"
                                BorderThickness="1"
                                HorizontalContentAlignment="Stretch"
                                VerticalContentAlignment="Stretch"
                                Tag="Normal"
                                Click="ModeButton_Click">
                            <StackPanel>
                                <wpfui:SymbolIcon Symbol="Battery1024"
                                                  Foreground="{DynamicResource AccentTextFillColorPrimaryBrush}"
                                                  FontSize="20"/>
                                <TextBlock Margin="0,8,0,2" Text="{x:Static libres:Resource.BatteryState_Normal}"
                                           FontWeight="SemiBold"
                                           Foreground="{DynamicResource TextFillColorPrimaryBrush}"/>
                                <TextBlock Text="Balanced for everyday use"
                                           FontSize="12"
                                           Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
                            </StackPanel>
                        </Button>

                        <!-- Rapid Charge Mode -->
                        <Button x:Name="_modeRapidButton"
                                Padding="12"
                                MinWidth="150"
                                Margin="0,0,12,12"
                                Background="{DynamicResource SubtleFillColorTransparentBrush}"
                                BorderBrush="{DynamicResource CardStrokeColorDefaultBrush}"
                                BorderThickness="1"
                                HorizontalContentAlignment="Stretch"
                                VerticalContentAlignment="Stretch"
                                Tag="RapidCharge"
                                Click="ModeButton_Click">
                            <StackPanel>
                                <wpfui:SymbolIcon Symbol="Flash24"
                                                  Foreground="{DynamicResource SystemFillColorSuccessBrush}"
                                                  FontSize="20"/>
                                <TextBlock Margin="0,8,0,2" Text="{x:Static libres:Resource.BatteryState_RapidCharge}"
                                           FontWeight="SemiBold"
                                           Foreground="{DynamicResource TextFillColorPrimaryBrush}"/>
                                <TextBlock Text="Fast charging when you need it"
                                           FontSize="12"
                                           Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
                            </StackPanel>
                        </Button>
                    </WrapPanel>
                </custom:CardControl>

                <!-- Overnight Battery Charging Toggle (stacked below on small widths) -->
                <dashboard:BatteryNightChargeModeControl Margin="0,12,0,0"/>
            </StackPanel>

            <!-- Quick Stats Grid -->
            <UniformGrid Columns="4" Margin="0,0,0,32" Rows="1">
                <!-- Temperature Card -->
                <custom:CardControl
                    Margin="0,0,16,0"
                    Background="{DynamicResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{DynamicResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    Effect="{DynamicResource CardShadow}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <wpfui:SymbolIcon
                            Grid.Row="0"
                            HorizontalAlignment="Center"
                            FontSize="24"
                            Foreground="{DynamicResource SystemFillColorCautionBrush}"
                            Symbol="Temperature24" />

                        <StackPanel Grid.Row="1" HorizontalAlignment="Center" VerticalAlignment="Center">
                            <TextBlock
                                x:Name="_batteryTemperatureText"
                                FontSize="18"
                                FontWeight="SemiBold"
                                Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                Text="32°C" />
                            <TextBlock
                                FontSize="12"
                                Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                                Text="Temperature" />
                        </StackPanel>
                    </Grid>
                </custom:CardControl>

                <!-- Power Consumption Card -->
                <custom:CardControl
                    Margin="0,0,16,0"
                    Background="{DynamicResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{DynamicResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    Effect="{DynamicResource CardShadow}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <wpfui:SymbolIcon
                            Grid.Row="0"
                            HorizontalAlignment="Center"
                            FontSize="24"
                            Foreground="{DynamicResource SystemFillColorSuccessBrush}"
                            Symbol="Flash24" />

                        <StackPanel Grid.Row="1" HorizontalAlignment="Center" VerticalAlignment="Center">
                            <TextBlock
                                x:Name="_batteryDischargeRateText"
                                FontSize="18"
                                FontWeight="SemiBold"
                                Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                Text="15.2W" />
                            <TextBlock
                                FontSize="12"
                                Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                                Text="Consumption" />
                        </StackPanel>
                    </Grid>
                </custom:CardControl>

                <!-- Cycle Count Card -->
                <custom:CardControl
                    Margin="0,0,16,0"
                    Background="{DynamicResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{DynamicResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    Effect="{DynamicResource CardShadow}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <wpfui:SymbolIcon
                            Grid.Row="0"
                            HorizontalAlignment="Center"
                            FontSize="24"
                            Foreground="{DynamicResource AccentTextFillColorPrimaryBrush}"
                            Symbol="ArrowRepeatAll24" />

                        <StackPanel Grid.Row="1" HorizontalAlignment="Center" VerticalAlignment="Center">
                            <TextBlock
                                x:Name="_batteryCycleCountText"
                                FontSize="18"
                                FontWeight="SemiBold"
                                Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                Text="127" />
                            <TextBlock
                                FontSize="12"
                                Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                                Text="Cycles" />
                        </StackPanel>
                    </Grid>
                </custom:CardControl>

                <!-- Time Remaining Card -->
                <custom:CardControl
                    Background="{DynamicResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{DynamicResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    Effect="{DynamicResource CardShadow}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <wpfui:SymbolIcon
                            Grid.Row="0"
                            HorizontalAlignment="Center"
                            FontSize="24"
                            Foreground="{DynamicResource SystemFillColorSuccessBrush}"
                            Symbol="Clock24" />

                        <StackPanel Grid.Row="1" HorizontalAlignment="Center" VerticalAlignment="Center">
                            <TextBlock
                                x:Name="_timeRemainingText"
                                FontSize="18"
                                FontWeight="SemiBold"
                                Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                Text="3h 42m" />
                            <TextBlock
                                FontSize="12"
                                Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                                Text="Remaining" />
                        </StackPanel>
                    </Grid>
                </custom:CardControl>
            </UniformGrid>

            <!-- Detailed Information Section -->
            <custom:CardControl
                Margin="0,0,0,24"
                Background="{DynamicResource CardBackgroundFillColorDefaultBrush}"
                BorderBrush="{DynamicResource CardStrokeColorDefaultBrush}"
                BorderThickness="1"
                Effect="{DynamicResource CardShadow}">
                <custom:CardControl.Header>
                    <controls:CardHeaderControl
                        Title="Detailed Information"
                        Subtitle="Comprehensive battery statistics" />
                </custom:CardControl.Header>

                <Grid Margin="0,16,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="24"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Left Column -->
                    <StackPanel Grid.Column="0">
                        <custom:CardControl
                            Margin="0,0,0,12"
                            Background="{DynamicResource SubtleFillColorTransparentBrush}"
                            BorderBrush="{DynamicResource CardStrokeColorDefaultBrush}"
                            BorderThickness="1">
                            <Grid Margin="12">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0" VerticalAlignment="Center">
                                    <TextBlock
                                        FontSize="14"
                                        FontWeight="Medium"
                                        Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                        Text="Current Capacity" />
                                    <TextBlock
                                        x:Name="_batteryCapacityText"
                                        FontSize="16"
                                        FontWeight="SemiBold"
                                        Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                                        Text="52.3 Wh" />
                                </StackPanel>

                                <wpfui:SymbolIcon
                                    Grid.Column="1"
                                    FontSize="20"
                                    Foreground="{DynamicResource AccentTextFillColorPrimaryBrush}"
                                    Symbol="BatteryCharge24" />
                            </Grid>
                        </custom:CardControl>

                        <custom:CardControl
                            Margin="0,0,0,12"
                            Background="{DynamicResource SubtleFillColorTransparentBrush}"
                            BorderBrush="{DynamicResource CardStrokeColorDefaultBrush}"
                            BorderThickness="1">
                            <Grid Margin="12">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0" VerticalAlignment="Center">
                                    <TextBlock
                                        FontSize="14"
                                        FontWeight="Medium"
                                        Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                        Text="Design Capacity" />
                                    <TextBlock
                                        x:Name="_batteryDesignCapacityText"
                                        FontSize="16"
                                        FontWeight="SemiBold"
                                        Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                                        Text="56.7 Wh" />
                                </StackPanel>

                                <wpfui:SymbolIcon
                                    Grid.Column="1"
                                    FontSize="20"
                                    Foreground="{DynamicResource SystemFillColorSuccessBrush}"
                                    Symbol="Battery1024" />
                            </Grid>
                        </custom:CardControl>

                        <custom:CardControl
                            Background="{DynamicResource SubtleFillColorTransparentBrush}"
                            BorderBrush="{DynamicResource CardStrokeColorDefaultBrush}"
                            BorderThickness="1">
                            <Grid Margin="12">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0" VerticalAlignment="Center">
                                    <TextBlock
                                        FontSize="14"
                                        FontWeight="Medium"
                                        Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                        Text="On Battery Since" />
                                    <TextBlock
                                        x:Name="_onBatterySinceText"
                                        FontSize="16"
                                        FontWeight="SemiBold"
                                        Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                                        Text="2h 15m ago" />
                                </StackPanel>

                                <wpfui:SymbolIcon
                                    Grid.Column="1"
                                    FontSize="20"
                                    Foreground="{DynamicResource SystemFillColorCautionBrush}"
                                    Symbol="ClockAlarm24" />
                            </Grid>
                        </custom:CardControl>
                    </StackPanel>

                    <!-- Spacer -->
                    <Grid Grid.Column="1"/>

                    <!-- Right Column -->
                    <StackPanel Grid.Column="2">
                        <custom:CardControl
                            Margin="0,0,0,12"
                            Background="{DynamicResource SubtleFillColorTransparentBrush}"
                            BorderBrush="{DynamicResource CardStrokeColorDefaultBrush}"
                            BorderThickness="1">
                            <Grid Margin="12">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0" VerticalAlignment="Center">
                                    <TextBlock
                                        FontSize="14"
                                        FontWeight="Medium"
                                        Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                        Text="Min Discharge Rate" />
                                    <TextBlock
                                        x:Name="_batteryMinDischargeRateText"
                                        FontSize="16"
                                        FontWeight="SemiBold"
                                        Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                                        Text="8.5 W" />
                                </StackPanel>

                                <wpfui:SymbolIcon
                                    Grid.Column="1"
                                    FontSize="20"
                                    Foreground="{DynamicResource SystemFillColorSuccessBrush}"
                                    Symbol="ArrowDown24" />
                            </Grid>
                        </custom:CardControl>

                        <custom:CardControl
                            Margin="0,0,0,12"
                            Background="{DynamicResource SubtleFillColorTransparentBrush}"
                            BorderBrush="{DynamicResource CardStrokeColorDefaultBrush}"
                            BorderThickness="1">
                            <Grid Margin="12">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0" VerticalAlignment="Center">
                                    <TextBlock
                                        FontSize="14"
                                        FontWeight="Medium"
                                        Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                        Text="Max Discharge Rate" />
                                    <TextBlock
                                        x:Name="_batteryMaxDischargeRateText"
                                        FontSize="16"
                                        FontWeight="SemiBold"
                                        Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                                        Text="85.2 W" />
                                </StackPanel>

                                <wpfui:SymbolIcon
                                    Grid.Column="1"
                                    FontSize="20"
                                    Foreground="{DynamicResource SystemFillColorCautionBrush}"
                                    Symbol="ArrowUp24" />
                            </Grid>
                        </custom:CardControl>

                        <custom:CardControl
                            Background="{DynamicResource SubtleFillColorTransparentBrush}"
                            BorderBrush="{DynamicResource CardStrokeColorDefaultBrush}"
                            BorderThickness="1">
                            <Grid Margin="12">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0" VerticalAlignment="Center">
                                    <TextBlock
                                        FontSize="14"
                                        FontWeight="Medium"
                                        Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                        Text="Full Charge Capacity" />
                                    <TextBlock
                                        x:Name="_batteryFullChargeCapacityText"
                                        FontSize="16"
                                        FontWeight="SemiBold"
                                        Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                                        Text="54.1 Wh" />
                                </StackPanel>

                                <wpfui:SymbolIcon
                                    Grid.Column="1"
                                    FontSize="20"
                                    Foreground="{DynamicResource SystemFillColorSuccessBrush}"
                                    Symbol="BatteryCharge24" />
                            </Grid>
                        </custom:CardControl>
                    </StackPanel>
                </Grid>
            </custom:CardControl>

            <!-- Battery History Section -->
            <custom:CardControl
                Margin="0,0,0,24"
                Background="{DynamicResource CardBackgroundFillColorDefaultBrush}"
                BorderBrush="{DynamicResource CardStrokeColorDefaultBrush}"
                BorderThickness="1"
                Effect="{DynamicResource CardShadow}">
                <custom:CardControl.Header>
                    <controls:CardHeaderControl
                        Title="Battery History"
                        Subtitle="Manufacture and usage information" />
                </custom:CardControl.Header>

                <Grid Margin="0,16,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="24"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Manufacture Date -->
                    <custom:CardControl
                        x:Name="_batteryManufactureDateCardControl"
                        Grid.Column="0"
                        Background="{DynamicResource SubtleFillColorTransparentBrush}"
                        BorderBrush="{DynamicResource CardStrokeColorDefaultBrush}"
                        BorderThickness="1">
                        <Grid Margin="16">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <wpfui:SymbolIcon
                                Grid.Row="0"
                                HorizontalAlignment="Center"
                                FontSize="32"
                                Foreground="{DynamicResource AccentTextFillColorPrimaryBrush}"
                                Symbol="CalendarLtr24" />

                            <StackPanel Grid.Row="1" HorizontalAlignment="Center" VerticalAlignment="Center">
                                <TextBlock
                                    x:Name="_batteryManufactureDateText"
                                    FontSize="16"
                                    FontWeight="SemiBold"
                                    Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                    Text="Jan 2022" />
                                <TextBlock
                                    FontSize="12"
                                    Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                                    Text="Manufacture Date" />
                            </StackPanel>
                        </Grid>
                    </custom:CardControl>

                    <!-- Spacer -->
                    <Grid Grid.Column="1"/>

                    <!-- First Use Date -->
                    <custom:CardControl
                        x:Name="_batteryFirstUseDateCardControl"
                        Grid.Column="2"
                        Background="{DynamicResource SubtleFillColorTransparentBrush}"
                        BorderBrush="{DynamicResource CardStrokeColorDefaultBrush}"
                        BorderThickness="1">
                        <Grid Margin="16">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <wpfui:SymbolIcon
                                Grid.Row="0"
                                HorizontalAlignment="Center"
                                FontSize="32"
                                Foreground="{DynamicResource SystemFillColorSuccessBrush}"
                                Symbol="CalendarLtr24" />

                            <StackPanel Grid.Row="1" HorizontalAlignment="Center" VerticalAlignment="Center">
                                <TextBlock
                                    x:Name="_batteryFirstUseDateText"
                                    FontSize="16"
                                    FontWeight="SemiBold"
                                    Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                    Text="Feb 2022" />
                                <TextBlock
                                    FontSize="12"
                                    Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                                    Text="First Use Date" />
                            </StackPanel>
                        </Grid>
                    </custom:CardControl>
                </Grid>
            </custom:CardControl>

            <!-- Warnings Section -->
            <StackPanel x:Name="_warningsPanel" Visibility="Collapsed">
                <custom:CardControl
                    Margin="0,0,0,16"
                    Background="{DynamicResource SystemFillColorCautionBackgroundBrush}"
                    BorderBrush="{DynamicResource SystemFillColorCautionBrush}"
                    BorderThickness="1">
                    <Grid Margin="16">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <wpfui:SymbolIcon
                            Grid.Column="0"
                            FontSize="24"
                            Foreground="{DynamicResource SystemFillColorCautionBrush}"
                            Symbol="Warning24" />

                        <StackPanel Grid.Column="1" Margin="12,0,0,0" VerticalAlignment="Center">
                            <TextBlock
                                x:Name="_lowBattery"
                                FontSize="14"
                                FontWeight="Medium"
                                Foreground="{DynamicResource SystemFillColorCautionBrush}"
                                Text="Battery level is low"
                                Visibility="Collapsed" />
                            <TextBlock
                                x:Name="_lowWattageCharger"
                                FontSize="14"
                                FontWeight="Medium"
                                Foreground="{DynamicResource SystemFillColorCautionBrush}"
                                Text="Low wattage charger detected"
                                Visibility="Collapsed" />
                        </StackPanel>
                    </Grid>
                </custom:CardControl>
            </StackPanel>

            <!-- Hidden elements for backward compatibility -->
            <TextBlock x:Name="_batteryIcon" Visibility="Collapsed" />
        </StackPanel>
    </Grid>
=======
        <!-- Enhanced Battery Overview -->
        <custom:CardControl Margin="0,0,0,24">
            <custom:CardControl.Header>
                <controls:CardHeaderControl Title="{x:Static resources:Resource.BatteryPage_Title}" Subtitle="Current battery status" />
            </custom:CardControl.Header>
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                <wpfui:SymbolIcon
                    x:Name="_batteryIcon"
                    FontSize="72"
                    Symbol="Battery024"
                    VerticalAlignment="Center"
                    Margin="0,0,24,0" />
                <StackPanel VerticalAlignment="Center">
                    <TextBlock
                        x:Name="_percentRemaining"
                        AutomationProperties.HelpText="{Binding RelativeSource={RelativeSource Mode=Self}, Path=Text}"
                        AutomationProperties.Name="{x:Static resources:Resource.BatteryPage_Title}"
                        FlowDirection="LeftToRight"
                        Focusable="True"
                        FontSize="48"
                        FontWeight="SemiBold"
                        HorizontalAlignment="Center"
                        Margin="0,0,0,8" />
                    <TextBlock
                        x:Name="_status"
                        AutomationProperties.HelpText="{Binding RelativeSource={RelativeSource Mode=Self}, Path=Text}"
                        AutomationProperties.Name="{x:Static resources:Resource.BatteryPage_Title}"
                        Focusable="True"
                        FontSize="16"
                        FontWeight="Medium"
                        Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                        HorizontalAlignment="Center"
                        Margin="0,0,0,4" />
                    <TextBlock
                        x:Name="_lowBattery"
                        Focusable="True"
                        FontSize="14"
                        Foreground="{DynamicResource SystemFillColorCautionBrush}"
                        Text="{x:Static resources:Resource.BatteryPage_LowLevel}"
                        Visibility="Hidden"
                        HorizontalAlignment="Center"
                        Margin="0,0,0,2" />
                    <TextBlock
                        x:Name="_lowWattageCharger"
                        Focusable="True"
                        FontSize="14"
                        Foreground="{DynamicResource SystemFillColorCautionBrush}"
                        Text="{x:Static resources:Resource.BatteryPage_LowWattageChargerConnected}"
                        Visibility="Hidden"
                        HorizontalAlignment="Center" />
                </StackPanel>
            </StackPanel>
        </custom:CardControl>

        <custom:CardControl x:Name="_batteryTemperatureCardControl" Margin="0,0,0,24">
            <custom:CardControl.Header>
                <controls:CardHeaderControl Title="{x:Static resources:Resource.BatteryPage_BatteryTemperature_Title}" Subtitle="{x:Static resources:Resource.BatteryPage_BatteryTemperature_Message}" />
            </custom:CardControl.Header>
            <TextBlock
                x:Name="_batteryTemperatureText"
                AutomationProperties.HelpText="{Binding RelativeSource={RelativeSource Mode=Self}, Path=Text}"
                AutomationProperties.Name="{x:Static resources:Resource.BatteryPage_BatteryTemperature_Title}"
                FlowDirection="LeftToRight"
                Focusable="True"
                FontSize="14" />
        </custom:CardControl>

        <custom:CardControl Margin="0,0,0,8">
            <custom:CardControl.Header>
                <controls:CardHeaderControl Title="{x:Static resources:Resource.BatteryPage_DischargeRate_Title}" Subtitle="{x:Static resources:Resource.BatteryPage_DischargeRate_Message}" />
            </custom:CardControl.Header>
            <TextBlock
                x:Name="_batteryDischargeRateText"
                AutomationProperties.HelpText="{Binding RelativeSource={RelativeSource Mode=Self}, Path=Text}"
                AutomationProperties.Name="{x:Static resources:Resource.BatteryPage_DischargeRate_Title}"
                FlowDirection="LeftToRight"
                Focusable="True"
                FontSize="14" />
        </custom:CardControl>

        <custom:CardControl Margin="0,0,0,8">
            <custom:CardControl.Header>
                <controls:CardHeaderControl Title="{x:Static resources:Resource.BatteryPage_MinDischargeRate_Title}" Subtitle="{x:Static resources:Resource.BatteryPage_MinDischargeRate_Message}" />
            </custom:CardControl.Header>
            <TextBlock
                x:Name="_batteryMinDischargeRateText"
                AutomationProperties.HelpText="{Binding RelativeSource={RelativeSource Mode=Self}, Path=Text}"
                AutomationProperties.Name="{x:Static resources:Resource.BatteryPage_MinDischargeRate_Title}"
                FlowDirection="LeftToRight"
                Focusable="True"
                FontSize="14" />
        </custom:CardControl>

        <custom:CardControl Margin="0,0,0,8">
            <custom:CardControl.Header>
                <controls:CardHeaderControl Title="{x:Static resources:Resource.BatteryPage_MaxDischargeRate_Title}" Subtitle="{x:Static resources:Resource.BatteryPage_MaxDischargeRate_Message}" />
            </custom:CardControl.Header>
            <TextBlock
                x:Name="_batteryMaxDischargeRateText"
                AutomationProperties.HelpText="{Binding RelativeSource={RelativeSource Mode=Self}, Path=Text}"
                AutomationProperties.Name="{x:Static resources:Resource.BatteryPage_MaxDischargeRate_Title}"
                FlowDirection="LeftToRight"
                Focusable="True"
                FontSize="14" />    
        </custom:CardControl>

        <custom:CardControl Margin="0,0,0,8">
            <custom:CardControl.Header>
                <controls:CardHeaderControl Title="{x:Static resources:Resource.BatteryPage_CurrentCapacity_Title}" Subtitle="{x:Static resources:Resource.BatteryPage_CurrentCapacity_Message}" />
            </custom:CardControl.Header>
            <TextBlock
                x:Name="_batteryCapacityText"
                AutomationProperties.HelpText="{Binding RelativeSource={RelativeSource Mode=Self}, Path=Text}"
                AutomationProperties.Name="{x:Static resources:Resource.BatteryPage_CurrentCapacity_Title}"
                FlowDirection="LeftToRight"
                Focusable="True"
                FontSize="14" />
        </custom:CardControl>

        <custom:CardControl Margin="0,0,0,8">
            <custom:CardControl.Header>
                <controls:CardHeaderControl Title="{x:Static resources:Resource.BatteryPage_FullChargeCapacity_Title}" Subtitle="{x:Static resources:Resource.BatteryPage_FullChargeCapacity_Message}" />
            </custom:CardControl.Header>
            <TextBlock
                x:Name="_batteryFullChargeCapacityText"
                AutomationProperties.HelpText="{Binding RelativeSource={RelativeSource Mode=Self}, Path=Text}"
                AutomationProperties.Name="{x:Static resources:Resource.BatteryPage_FullChargeCapacity_Title}"
                FlowDirection="LeftToRight"
                Focusable="True"
                FontSize="14" />
        </custom:CardControl>

        <custom:CardControl Margin="0,0,0,8">
            <custom:CardControl.Header>
                <controls:CardHeaderControl Title="{x:Static resources:Resource.BatteryPage_DesignCapacity_Title}" Subtitle="{x:Static resources:Resource.BatteryPage_DesignCapacity_Message}" />
            </custom:CardControl.Header>
            <TextBlock
                x:Name="_batteryDesignCapacityText"
                AutomationProperties.HelpText="{Binding RelativeSource={RelativeSource Mode=Self}, Path=Text}"
                AutomationProperties.Name="{x:Static resources:Resource.BatteryPage_DesignCapacity_Title}"
                FlowDirection="LeftToRight"
                Focusable="True"
                FontSize="14" />
        </custom:CardControl>

        <custom:CardControl Margin="0,0,0,24">
            <custom:CardControl.Header>
                <controls:CardHeaderControl Title="{x:Static resources:Resource.BatteryPage_BatteryHealth_Title}" Subtitle="{x:Static resources:Resource.BatteryPage_BatteryHealth_Message}" />
            </custom:CardControl.Header>
            <TextBlock
                x:Name="_batteryHealthText"
                AutomationProperties.HelpText="{Binding RelativeSource={RelativeSource Mode=Self}, Path=Text}"
                AutomationProperties.Name="{x:Static resources:Resource.BatteryPage_BatteryHealth_Title}"
                FlowDirection="LeftToRight"
                Focusable="True"
                FontSize="14" />    
        </custom:CardControl>

        <custom:CardControl Margin="0,0,0,8">
            <custom:CardControl.Header>
                <controls:CardHeaderControl Title="{x:Static resources:Resource.BatteryPage_OnBatterySince_Title}" Subtitle="{x:Static resources:Resource.BatteryPage_OnBatterySince_Message}" />
            </custom:CardControl.Header>
            <TextBlock
                x:Name="_onBatterySinceText"
                AutomationProperties.HelpText="{Binding RelativeSource={RelativeSource Mode=Self}, Path=Text}"
                AutomationProperties.Name="{x:Static resources:Resource.BatteryPage_OnBatterySince_Title}"
                FlowDirection="LeftToRight"
                Focusable="True"
                FontSize="14" />
        </custom:CardControl>

        <custom:CardControl Margin="0,0,0,8">
            <custom:CardControl.Header>
                <controls:CardHeaderControl Title="{x:Static resources:Resource.BatteryPage_CycleCount_Title}" Subtitle="{x:Static resources:Resource.BatteryPage_CycleCount_Message}" />
            </custom:CardControl.Header>
            <TextBlock
                x:Name="_batteryCycleCountText"
                AutomationProperties.HelpText="{Binding RelativeSource={RelativeSource Mode=Self}, Path=Text}"
                AutomationProperties.Name="{x:Static resources:Resource.BatteryPage_CycleCount_Title}"
                FlowDirection="LeftToRight"
                Focusable="True"
                FontSize="14" />
        </custom:CardControl>

        <custom:CardControl x:Name="_batteryManufactureDateCardControl" Margin="0,0,0,8">
            <custom:CardControl.Header>
                <controls:CardHeaderControl Title="{x:Static resources:Resource.BatteryPage_ManufactureDate_Title}" Subtitle="{x:Static resources:Resource.BatteryPage_ManufactureDate_Message}" />
            </custom:CardControl.Header>
            <TextBlock
                x:Name="_batteryManufactureDateText"
                AutomationProperties.HelpText="{Binding RelativeSource={RelativeSource Mode=Self}, Path=Text}"
                AutomationProperties.Name="{x:Static resources:Resource.BatteryPage_ManufactureDate_Title}"
                FlowDirection="LeftToRight"
                Focusable="True"
                FontSize="14" />
        </custom:CardControl>

        <custom:CardControl x:Name="_batteryFirstUseDateCardControl" Margin="0,0,0,8">
            <custom:CardControl.Header>
                <controls:CardHeaderControl Title="{x:Static resources:Resource.BatteryPage_FirstUseDate_Title}" Subtitle="{x:Static resources:Resource.BatteryPage_FirstUse_Message}" />
            </custom:CardControl.Header>
            <TextBlock
                x:Name="_batteryFirstUseDateText"
                AutomationProperties.HelpText="{Binding RelativeSource={RelativeSource Mode=Self}, Path=Text}"
                AutomationProperties.Name="{x:Static resources:Resource.BatteryPage_FirstUseDate_Title}"
                FlowDirection="LeftToRight"
                Focusable="True"
                FontSize="14" />
        </custom:CardControl>

    </StackPanel>
>>>>>>> Stashed changes
</wpfui:UiPage>
